<div class="home-shell">
	<div class="hero hero-card">
		<div class="hero-inner">
			<h1 class="portal-title">Data Marketplace</h1>
			<p class="subtitle">Discover products • Explore models • Orchestrate agents • View BI insights</p>
			<div class="tag-row">
				<span class="mini-tag">Fabric Catalog</span>
				<span class="mini-tag">AI Foundry</span>
				<span class="mini-tag">Access Control</span>
			</div>
		</div>
	</div>

	<div class="action-row">
		<button class="portal-btn" routerLink="/browse"><span class="ico">▣</span> <span>Browse Data</span></button>
		<button class="portal-btn" disabled><span class="ico">⚙</span> <span>Models</span></button>
		<button class="portal-btn" disabled><span class="ico">⚑</span> <span>Agents</span></button>
		<button class="portal-btn" disabled><span class="ico">⋈</span> <span>Dashboards</span></button>
	</div>

	<div class="conversation card">
		<div class="section-head">Conversational Access</div>
		<div class="chat-box">
			<div class="messages" *ngIf="ai.messages().length; else emptyState">
				<div class="msg" *ngFor="let m of ai.messages()" [class.user]="m.role==='user'" [class.ai]="m.role==='ai'">
					<div class="bubble">{{m.text}}</div>
				</div>
				<div class="msg ai" *ngIf="ai.sending()"><div class="bubble">Thinking…</div></div>
			</div>
			<ng-template #emptyState>
				<p class="hint">Ask about a data product, table, or metric. Try: “List schemas for Sales Orders”</p>
			</ng-template>
			<form class="composer" (submit)="onSubmit($event)">
				<textarea #ta [value]="prompt()" (input)="prompt.set(ta.value)" (keydown.enter)="onEnter($event)" rows="3" placeholder="Ask about a data product"></textarea>
				<div class="composer-actions">
					<button type="submit" class="send" [disabled]="ai.sending() || !prompt().trim()">Send</button>
					<button type="button" class="reset" (click)="ai.reset()" [disabled]="ai.sending() || !ai.messages().length">Reset</button>
				</div>
			</form>
		</div>
	</div>

	<div class="lower-grid">
		<div class="metrics card">
			<div class="section-head">Key Metrics</div>
			<div *ngIf="products.isLoading(); else kpis" class="kpi-grid loading">
				<div class="kpi-box skeleton" *ngFor="let n of [].constructor(4)">
					<div class="kpi-value shimmer w40"></div>
					<div class="kpi-label shimmer w60"></div>
				</div>
			</div>
			<ng-template #kpis>
				<div class="kpi-grid">
					<div class="kpi-box" aria-label="{{totalProducts()}} data products available"><div class="kpi-value">{{totalProducts()}}</div><div class="kpi-label">Data Products</div></div>
					<div class="kpi-box" aria-label="0 models registered"><div class="kpi-value">0</div><div class="kpi-label">Models</div></div>
					<div class="kpi-box" aria-label="0 active agents"><div class="kpi-value">0</div><div class="kpi-label">Agents</div></div>
					<div class="kpi-box" aria-label="{{totalDomains()}} business domains"><div class="kpi-value">{{totalDomains()}}</div><div class="kpi-label">Domains</div></div>
				</div>
				<div class="top-products" *ngIf="topThree().length">
					<h4>Top Rated</h4>
					<ul>
						<li *ngFor="let p of topThree()">{{p.name}} <span class="mini" *ngIf="p.rating">★ {{p.rating}}</span></li>
					</ul>
				</div>
			</ng-template>
		</div>
		<div class="psl card">
			<div class="section-head">Product Service Line</div>
			<p>Browse products by Product Service Line categories (coming soon).</p>
		</div>
	</div>
</div>
