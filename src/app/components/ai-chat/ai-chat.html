<div class="chat-container">
  <div class="chat-header">
    <h2>AI Chat</h2>
    <p class="chat-description">
      Ask questions about available data products and get AI-powered insights
    </p>
    <button mat-icon-button (click)="clearChat()" title="Clear Chat">
      <mat-icon>clear_all</mat-icon>
    </button>
  </div>

  <mat-card class="chat-messages">
    <div class="messages-container" #messagesContainer>
      <!-- Welcome message -->
      <div class="message assistant-message" *ngIf="messages.length === 0">
        <div class="message-content">
          <mat-icon class="message-icon">smart_toy</mat-icon>
          <div class="message-text">
            <p><strong>Welcome to AI Chat!</strong></p>
            <p>I can help you discover and understand available data products. Try asking:</p>
            <ul>
              <li>"What data products are available?"</li>
              <li>"Show me analytics datasets"</li>
              <li>"What machine learning models can I access?"</li>
            </ul>
          </div>
        </div>
      </div>

      <!-- Chat messages -->
      <div 
        class="message" 
        [ngClass]="message.role === 'user' ? 'user-message' : 'assistant-message'"
        *ngFor="let message of messages"
      >
        <div class="message-content">
          <mat-icon class="message-icon">
            {{ message.role === 'user' ? 'person' : 'smart_toy' }}
          </mat-icon>
          <div class="message-text">
            <p>{{ message.content }}</p>
            <small class="timestamp">
              {{ message.timestamp | date:'short' }}
            </small>
          </div>
        </div>
      </div>

      <!-- Loading indicator -->
      <div class="message assistant-message" *ngIf="isLoading">
        <div class="message-content">
          <mat-icon class="message-icon">smart_toy</mat-icon>
          <div class="message-text">
            <mat-spinner diameter="20"></mat-spinner>
            <span class="loading-text">AI is thinking...</span>
          </div>
        </div>
      </div>
    </div>
  </mat-card>

  <div class="chat-input">
    <mat-card>
      <div class="input-container">
        <mat-form-field appearance="outline" class="message-input">
          <mat-label>Type your message...</mat-label>
          <textarea 
            matInput
            [(ngModel)]="newMessage"
            (keypress)="onKeyPress($event)"
            [disabled]="isLoading"
            placeholder="Ask about data products, analytics, or anything else..."
            rows="2"
          ></textarea>
        </mat-form-field>
        <button 
          mat-fab 
          color="primary" 
          (click)="sendMessage()"
          [disabled]="!newMessage.trim() || isLoading"
          class="send-button"
        >
          <mat-icon>send</mat-icon>
        </button>
      </div>
    </mat-card>
  </div>
</div>
